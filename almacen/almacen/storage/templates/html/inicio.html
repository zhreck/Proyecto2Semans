{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>P√°gina de Inicio</title>
    <link rel="stylesheet" href="{% static 'css/inicio.css' %}">
  </head>

  <!-- URL base para el JS (redirige b√∫squedas y ciudades) -->
  <body data-productos="{% url 'productos' %}">

    <!-- Header -->
    <header class="header">
      <div class="nav-container">
        <div class="logo">BodegasChile</div>
        <nav class="nav-buttons">
          <a href="{% url 'inicio' %}" class="nav-btn">Inicio</a>
          <a href="{% url 'acceso' %}" class="nav-btn">Acceder</a>
          <a href="{% url 'ayuda' %}" class="nav-btn">Ayuda</a>
          <a href="{% url 'publicar' %}" class="nav-btn">Publicar propiedad</a> 
        </nav>
      </div>
    </header>

    <!-- Hero + Carrusel -->
    <section class="hero">
      <div class="hero-content">
        <div style="color:#666;font-size:1.2rem;margin-bottom:8px;"></div>

        <div class="carousel" id="carousel">
          <button class="carousel-btn prev" aria-label="Anterior" id="prevBtn">&#10094;</button>

          <div class="carousel-track" id="carouselTrack">
            {% for foto in fotos %}
              <div class="carousel-slide">
                <img src="{{ foto.archivo.url }}" alt="{{ foto.nombre|default:'Foto' }}">
              </div>
            {% empty %}
              <div class="carousel-slide">
                <img src="{% static 'img/placeholder-wide.jpg' %}" alt="Sin fotos a√∫n">
              </div>
            {% endfor %}
          </div>

          <button class="carousel-btn next" aria-label="Siguiente" id="nextBtn">&#10095;</button>
        </div>
      </div>
    </section>

    <!-- Search -->
    <section class="search-section">
      <div class="search-controls">
        <div class="search-group">
          <label>Venta</label>
          <select class="search-select" id="operacion">
            <option value="venta" selected>Venta</option>
            <option value="arriendo">Arriendo</option>
          </select>
        </div>
        <div class="search-group">
          <label>Sector</label>
          <input type="text" class="search-input" id="sector" placeholder="Ingresa ubicaci√≥n">
        </div>
        <button class="search-btn">Buscar</button>
        <button class="search-btn map-btn">Buscar en Mapa</button>
      </div>
    </section>

    <!-- Main -->
    <main class="main-content">
      <!-- Destacados -->
      <section>
        <h2 class="section-title">Destacados</h2>
        <div class="property-grid">
          {% for p in propiedades %}
            <div class="property-card">
              <div class="property-image">
                <!-- üëÅ Badge de vistas -->
                <span class="badge-views" title="{{ p.vistas|intcomma }} vistas">
                  <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor"
                      d="M12 5c5.05 0 9.27 3.11 10.77 7.5C21.27 16.89 17.05 20 12 20S2.73 16.89 1.23 12.5C2.73 8.11 6.95 5 12 5m0 2C8.41 7 5.34 9.06 4 12.5C5.34 15.94 8.41 18 12 18s6.66-2.06 8-5.5C18.66 9.06 15.59 7 12 7m0 2a3.5 3.5 0 0 1 0 7a3.5 3.5 0 0 1 0-7"/>
                  </svg>
                  {{ p.vistas|intcomma }}
                </span>
                <img src="{{ p.foto.url }}" alt="Propiedad {{ p.id }}">
              </div>
              <div class="property-info">
                <div class="property-price">Desde ${{ p.precio|intcomma }}</div>
                <div class="property-location">Bodega en Venta en<br>{{ p.comuna }}</div>
              </div>
            </div>
          {% empty %}
            <p class="description">Sin propiedades por ahora.</p>
          {% endfor %}
        </div>
      </section>

      <!-- Mayores vistas -->
      <section class="section--alt">
        <h2 class="section-title">Mayores vistas</h2>
        <div class="property-grid">
          {% for p in mas_vistas %}
            <div class="property-card">
              <div class="property-image">
                <!-- üëÅ Badge de vistas -->
                <span class="badge-views" title="{{ p.vistas|intcomma }} vistas">
                  <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor"
                      d="M12 5c5.05 0 9.27 3.11 10.77 7.5C21.27 16.89 17.05 20 12 20S2.73 16.89 1.23 12.5C2.73 8.11 6.95 5 12 5m0 2C8.41 7 5.34 9.06 4 12.5C5.34 15.94 8.41 18 12 18s6.66-2.06 8-5.5C18.66 9.06 15.59 7 12 7m0 2a3.5 3.5 0 0 1 0 7a3.5 3.5 0 0 1 0-7"/>
                  </svg>
                  {{ p.vistas|intcomma }}
                </span>
                <img src="{{ p.foto.url }}" alt="Propiedad {{ p.id }}" loading="lazy">
              </div>
              <div class="property-info">
                <div class="property-price">Desde ${{ p.precio|intcomma }}</div>
                <div class="property-location">Bodega en Venta en<br>{{ p.comuna }}</div>
              </div>
            </div>
          {% empty %}
            <p class="description" style="margin-top:0">A√∫n no hay m√°s vistas.</p>
          {% endfor %}
        </div>
      </section>

      <!-- Cities -->
      <section class="cities-section">
        <h3>Propiedades en Chile</h3>
        <div class="cities-grid">
          <div class="city-card"><div class="city-image">Antofagasta</div></div>
          <div class="city-card"><div class="city-image">Conc√≥n</div></div>
          <div class="city-card"><div class="city-image">Coquimbo</div></div>
          <div class="city-card"><div class="city-image">Santiago</div></div>
          <div class="city-card"><div class="city-image">Temuco</div></div>
          <div class="city-card"><div class="city-image">La Serena</div></div>
          <div class="city-card"><div class="city-image">Puc√≥n</div></div>
          <div class="city-card"><div class="city-image">Vi√±a del Mar</div></div>
          <div class="city-card"><div class="city-image">Iquique</div></div>
          <div class="city-card"><div class="city-image">Mendoza</div></div>
          <div class="city-card"><div class="city-image">Lonquimay</div></div>
          <div class="city-card"><div class="city-image">Valdivia</div></div>
          <div class="city-card"><div class="city-image">Pto. Varas</div></div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p>&copy; 2024 BodegasChile. Todos los derechos reservados.</p>
    </footer>

    <!-- JS -->
    <script src="{% static 'js/inicio.js' %}"></script>
  </body>
</html>
